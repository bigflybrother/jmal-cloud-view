(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d60710dc"],{"037b":function(e,t,r){},2017:function(e,t,r){"use strict";r("b12d")},"3bff":function(e,t,r){"use strict";r("037b")},"9bf0":function(e,t,r){"use strict";r.d(t,"d",(function(){return s})),r.d(t,"c",(function(){return o})),r.d(t,"e",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r("b775");function s(e){return Object(n["a"])({url:"/public/website/record",method:"get",params:e})}function o(e){return Object(n["a"])({url:"/website/setting",method:"get",params:e})}function i(e){return Object(n["a"])({url:"/website/setting/update",method:"put",data:e})}function a(e){return Object(n["a"])({url:"/website/heartwings",method:"get",params:e})}t["a"]={sync:function(e){return Object(n["a"])({url:"/user/setting/sync",method:"get",params:e})},getWebp:function(e){return Object(n["a"])({url:"/user/setting/get/webp",method:"get",params:e})},disabledWebp:function(e){return Object(n["a"])({url:"/user/setting/disabled/webp",method:"put",params:e})},getAccessTokenList:function(e){return Object(n["a"])({url:"/user/setting/accessTokenList",method:"get",params:e})},generateAccessToken:function(e){return Object(n["a"])({url:"/user/setting/generateAccessToken",method:"put",params:e})},deleteAccessToken:function(e){return Object(n["a"])({url:"/user/setting/deleteAccessToken",method:"delete",params:e})},resetMenuAndRole:function(){return Object(n["a"])({url:"/user/setting/resetMenuAndRole",method:"put"})}}},"9ed6":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"login-container"},[r("div",{attrs:{id:"stars"}}),e._v(" "),r("div",{attrs:{id:"stars2"}}),e._v(" "),r("div",{attrs:{id:"stars3"}}),e._v(" "),r("el-card",{staticClass:"box-card"},[r("el-form",{ref:"loginForm",staticClass:"login-form",attrs:{model:e.loginForm,rules:e.loginRules,"auto-complete":"on","label-position":"left"}},[r("div",{staticClass:"title-container"},[e.initialize?e._e():r("h3",{staticClass:"title"},[r("span",{staticClass:"jmal-cloud-log"},[r("svg-icon",{attrs:{"icon-class":"jmal-cloud"}})],1),e._v(" "),r("span",[e._v("JmalCloud")])]),e._v(" "),e.initialize?r("h3",{staticClass:"title"},[e._v("创建管理员")]):e._e()]),e._v(" "),r("el-form-item",{attrs:{prop:"username"}},[r("span",{staticClass:"svg-container"},[r("svg-icon",{attrs:{"icon-class":"user"}})],1),e._v(" "),r("el-input",{ref:"username",attrs:{placeholder:"用户名",name:"username",type:"text",tabindex:"1","auto-complete":"on"},model:{value:e.loginForm.username,callback:function(t){e.$set(e.loginForm,"username",t)},expression:"loginForm.username"}})],1),e._v(" "),r("el-form-item",{attrs:{prop:"password"}},[r("span",{staticClass:"svg-container"},[r("svg-icon",{attrs:{"icon-class":"password"}})],1),e._v(" "),r("el-input",{key:e.passwordType,ref:"password",attrs:{type:e.passwordType,placeholder:"密码",name:"password",tabindex:"2","auto-complete":"on"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleLogin.apply(null,arguments)}},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}}),e._v(" "),r("span",{staticClass:"show-pwd",on:{click:e.showPwd}},[r("svg-icon",{attrs:{"icon-class":"password"===e.passwordType?"eye":"eye-open"}})],1)],1),e._v(" "),e.initialize?e._e():r("el-form-item",{staticClass:"remember"},[r("el-checkbox",{attrs:{label:"记住我"},model:{value:e.loginForm.rememberMe,callback:function(t){e.$set(e.loginForm,"rememberMe",t)},expression:"loginForm.rememberMe"}})],1),e._v(" "),e.initialize?r("el-form-item",{attrs:{prop:"confirmPassword"}},[r("span",{staticClass:"svg-container"},[r("svg-icon",{attrs:{"icon-class":"password"}})],1),e._v(" "),r("el-input",{key:e.passwordType,ref:"password",attrs:{type:e.passwordType,placeholder:"确认密码",name:"password",tabindex:"2","auto-complete":"on"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleLogin.apply(null,arguments)}},model:{value:e.loginForm.confirmPassword,callback:function(t){e.$set(e.loginForm,"confirmPassword",t)},expression:"loginForm.confirmPassword"}}),e._v(" "),r("span",{staticClass:"show-pwd",on:{click:e.showPwd}},[r("svg-icon",{attrs:{"icon-class":"password"===e.passwordType?"eye":"eye-open"}})],1)],1):e._e(),e._v(" "),r("el-button",{staticStyle:{width:"100%",margin:"30px 0"},attrs:{loading:e.loading,type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.handleLogin.apply(null,arguments)}}},[e._v(e._s(e.initialize?"创建":"登录"))])],1)],1),e._v(" "),r("footer",{staticClass:"clearfix",attrs:{id:"footer"}},[r("br"),r("br"),r("br"),e._v(" "),r("div",{staticClass:"copyright"},[r("p",[r("span",[e._v(e._s(e.webstieRecord.copyright))])]),e._v(" "),r("p",[r("a",{attrs:{href:"http://beian.miit.gov.cn",target:"_blank"}},[e._v(e._s(e.webstieRecord.recordPermissionNum))])])]),e._v(" "),r("br")])],1)},s=[],o=r("9bf0"),i=r("c24f"),a=r("5f87"),c=(r("4360"),{name:"Login",data:function(){var e=this,t=function(t,r,n){e.validUsername(r)?n():n(new Error("请输入正确的用户名"))},n=function(e,t,r){t.length<6?r(new Error("密码不能少于6位数字")):r()},s=function(t,r,n){r.length<6?n(new Error("密码不能少于6位数字")):e.loginForm.password!==r?n(new Error("密码不一致")):n()};return{webstieRecord:{copyright:"Copyright © 2020 Journey Magical AL",recordPermissionNum:'"鄂 ICP 备 2020021454 号 - 1"'},loginForm:{username:"",password:"",rememberMe:!1,confirmPassword:""},loginRules:{username:[{required:!0,trigger:"blur",validator:t}],password:[{required:!0,trigger:"blur",validator:n}],confirmPassword:[{required:!0,trigger:"blur",validator:s}]},loading:!1,passwordType:"password",redirect:void 0,initialize:!1,backgroundImg:{background:"url("+r("a598")+")",width:"100%",height:"100%",position:"absolute"}}},watch:{$route:{handler:function(e){this.redirect=e.query&&e.query.redirect,e.query.path&&(this.redirect+="&path=".concat(e.query.path))},immediate:!0}},mounted:function(){var e=this;Object(i["d"])().then((function(t){t.count<1&&(e.initialize=!0)}));var t=Object(a["b"])();t&&(this.loginForm.username=t,this.loginForm.rememberMe=!0),Object(o["d"])().then((function(t){e.webstieRecord=t.data}))},methods:{showPwd:function(){var e=this;"password"===this.passwordType?this.passwordType="":this.passwordType="password",this.$nextTick((function(){e.$refs.password.focus()}))},handleLogin:function(){var e=this;this.$refs.loginForm.validate((function(t){if(!t)return!1;if(e.initialize){var r=new FormData;r.append("username",e.loginForm.username),r.append("password",e.loginForm.password),Object(i["e"])(r).then((function(){e.initialize=!1,e.$message.success("创建成功")}))}else e.loading=!0,e.$store.dispatch("user/login",e.loginForm).then((function(){e.$store.dispatch("user/setMenuList").then((function(t){console.log(e.redirect),e.$router.push({path:e.redirect||"/"}),e.loading=!1})).catch((function(){e.loading=!1}))})).catch((function(){e.loading=!1}))}))},validUsername:function(){return!0}}}),l=c,u=(r("2017"),r("3bff"),r("2877")),d=Object(u["a"])(l,n,s,!1,null,"130e3ff3",null);t["default"]=d.exports},a598:function(e,t,r){e.exports=r.p+"static/img/login-bg.72db061a.png"},b12d:function(e,t,r){}}]);